/*
 * autoMove.c
 *
 *  Created on: Apr 15, 2024
 *      Author: kccistc
 */

#include "autoMove.h"
#include "ultraSonic.h"
#include "Motor.h"

void initAutoMove(TIM_HandleTypeDef* htim4){
	MoveStop(htim4);
}

void ultraSonicAutoMove(uint16_t L_dist, uint16_t C_dist, uint16_t R_dist, TIM_HandleTypeDef* htim4){
	uint16_t L_dist, C_dist, R_dist;
	L_dist = getDistance_L(&htim11, &htim2);
	C_dist = getDistance_C(&htim11, &htim2);
	R_dist = getDistance_R(&htim11, &htim2);
	if(C_dist > 130) {
		goMove(htim4);
	}
	if(C_dist <= 130 && C_dist > 30){
		if(L_dist < R_dist && R_dist > 50){
			rightDriveForward();
			htim4->Instance->CCR2 = 65535;
		}
		else if(L_dist >= R_dist && L_dist > 50){
		  leftDriveForward();
		  htim4->Instance->CCR1 = 65535;
		}
	}
	if(C_dist <= 10){
		MoveStop(htim4);
		backMove(htim4);
	}
}


